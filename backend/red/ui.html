<!-- <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kolam Analyzer & Recreator</title>
<style>
body { font-family: sans-serif; background: #F5E6D3; margin:0; padding:20px; }
.container { max-width: 900px; margin:auto; background:#fff; padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1);}
h1 { text-align:center; color:#8B4513; margin-bottom:20px;}
.upload-zone { border:3px dashed #A0522D; padding:40px; text-align:center; cursor:pointer; margin-bottom:20px; border-radius:15px;}
.upload-zone.dragover { background:rgba(160,82,45,0.1);}
.uploaded-image img { max-width:100%; border-radius:10px;}
.button-group { display:flex; justify-content:center; gap:20px; margin-bottom:20px;}
button { padding:10px 25px; border:none; border-radius:25px; background:#A0522D; color:#fff; font-weight:bold; cursor:pointer;}
button:disabled { background: rgba(160,82,45,0.4); cursor:not-allowed;}
.results { display:flex; gap:20px; justify-content:space-around; flex-wrap:wrap;}
.result-box { background: #fff3e6; padding:20px; border-radius:15px; width:45%;}
.result-box img { max-width:100%; border-radius:10px;}
</style>
</head>
<body>
<div class="container">
    <h1>ðŸŒ¸ Kolam Analyzer & Recreator ðŸŒ¸</h1>
    <div class="upload-zone" id="uploadZone">
        <p>Drag & drop or click to upload an image</p>
        <input type="file" id="imageInput" accept="image/*" style="display:none;">
        <div class="uploaded-image" id="uploadedImage" style="display:none;">
            <img id="previewImage">
            <button onclick="removeImage()">âœ•</button>
        </div>
    </div>

    <div class="button-group">
        <button id="analyzeBtn" disabled onclick="startAnalysis()">Analyze</button>
        <button id="recreateBtn" disabled onclick="startRecreation()">Recreate</button>
    </div>

    <div class="results">
        <div class="result-box" id="analysisResults" style="display:none;">
            <h3>Analysis</h3>
            <div id="resultsGrid"></div>
        </div>
        <div class="result-box" id="recreationResults" style="display:none;">
            <h3>Recreation</h3>
            <div id="recreatedImageContainer"></div>
        </div>
        <div class="color-options">
            <label>Line Color: <input type="color" id="strokeColor" value="#000000"></label>
            <label>Dot Color: <input type="color" id="dotColor" value="#ff0000"></label>
            <label>Line Width: <input type="number" id="strokeWidth" value="2" min="1"></label>
            <label>Dot Radius: <input type="number" id="dotRadius" value="3" min="1"></label>
        </div>
        
    </div>
</div>

 <script>
const FLASK_API_URL = '';

const uploadZone = document.getElementById('uploadZone');
const imageInput = document.getElementById('imageInput');
const uploadedImageContainer = document.getElementById('uploadedImage');
const previewImage = document.getElementById('previewImage');
const analyzeBtn = document.getElementById('analyzeBtn');
const recreateBtn = document.getElementById('recreateBtn');
let currentFile = null;

uploadZone.addEventListener('click', ()=> imageInput.click());
uploadZone.addEventListener('dragover', e=>{ e.preventDefault(); uploadZone.classList.add('dragover');});
uploadZone.addEventListener('dragleave', e=>{ e.preventDefault(); uploadZone.classList.remove('dragover');});
uploadZone.addEventListener('drop', e=>{ e.preventDefault(); uploadZone.classList.remove('dragover'); handleUpload(e.dataTransfer.files[0]); });
imageInput.addEventListener('change', e=> handleUpload(e.target.files[0]));

function handleUpload(file){
    if(!file.type.startsWith('image/')) return alert('Not an image.');
    currentFile = file;
    previewImage.src = URL.createObjectURL(file);
    uploadedImageContainer.style.display='block';
    analyzeBtn.disabled=false;
    recreateBtn.disabled=false;
}

function removeImage(){
    currentFile=null;
    uploadedImageContainer.style.display='none';
    analyzeBtn.disabled=true;
    recreateBtn.disabled=true;
    document.getElementById('resultsGrid').innerHTML='';
    document.getElementById('recreatedImageContainer').innerHTML='';
}

async function startAnalysis(){
    if(!currentFile) return;
    analyzeBtn.disabled=true; recreateBtn.disabled=true;
    const formData=new FormData(); formData.append('image',currentFile);
    try{
        const resp=await fetch(`${FLASK_API_URL}/analyze`,{method:'POST', body:formData});
        const data=await resp.json();
        displayAnalysis(data);
    }catch(e){ alert('Analysis error'); console.error(e);}
    finally{ analyzeBtn.disabled=false; recreateBtn.disabled=false;}
}

async function startRecreation(){
    if(!currentFile) return;
    recreateBtn.disabled=true; analyzeBtn.disabled=true;
    const formData=new FormData(); formData.append('image',currentFile);
    try{
        const resp=await fetch(`${FLASK_API_URL}/recreate`,{method:'POST', body:formData});
        const blob=await resp.blob();
        displayRecreation(URL.createObjectURL(blob));
    }catch(e){ alert('Recreation error'); console.error(e);}
    finally{ recreateBtn.disabled=false; analyzeBtn.disabled=false;}
}

function displayAnalysis(data){
    const grid=document.getElementById('resultsGrid');
    grid.innerHTML='';
    const principles={
        "Dot Count": data.dot_count,
        "Contour Count": data.contour_count,
        "Grid": data.grid.rows+'x'+data.grid.cols,
        "Symmetric": data.is_symmetric?'Yes':'No'
    };
    for(const [k,v] of Object.entries(principles)){
        const div=document.createElement('div'); div.textContent=`${k}: ${v}`; grid.appendChild(div);
    }
    document.getElementById('analysisResults').style.display='block';
}

function displayRecreation(url){
    const container=document.getElementById('recreatedImageContainer');
    container.innerHTML=`<img src="${url}">`;
    document.getElementById('recreationResults').style.display='block';
} 


async function startRecreation() {
    if (!currentFile) return;

    recreateBtn.textContent = 'Recreating...';
    analyzeBtn.disabled = true;
    recreateBtn.disabled = true;

    const formData = new FormData();
    formData.append('image', currentFile);

    try {
        const response = await fetch(`${FLASK_API_URL}/recreate`, {
            method: 'POST',
            body: formData,
        });

        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

        const svgText = await response.text();
        displayRecreatedSVG(svgText);

    } catch (error) {
        console.error("Error during recreation:", error);
        alert("An error occurred during recreation.");
    } finally {
        recreateBtn.textContent = 'Recreate Design';
        analyzeBtn.disabled = false;
        recreateBtn.disabled = false;
    }
}

function displayRecreatedSVG(svgContent) {
    recreatedImageContainer.innerHTML = ''; // Clear previous
    const div = document.createElement('div');
    div.innerHTML = svgContent;
    recreatedImageContainer.appendChild(div);
    recreationResultsContainer.style.display = 'block';
    analysisResultsContainer.style.display = 'none';
}
const formData = new FormData();
formData.append('image', currentFile);
formData.append('stroke_color', document.getElementById('strokeColor').value);
formData.append('dot_color', document.getElementById('dotColor').value);
formData.append('stroke_width', document.getElementById('strokeWidth').value);
formData.append('dot_radius', document.getElementById('dotRadius').value);



</script>
</body>
</html> -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ðŸŒ¸ Kolam Analyzer & Recreator ðŸŒ¸</title>
<style>
    body { font-family: 'Segoe UI', sans-serif; margin:0; padding:20px; background: #F5E6D3; }
    .container { max-width: 900px; margin:auto; background:#fff; padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1);}
    h1 { text-align:center; color:#8B4513; margin-bottom:20px;}
    .upload-zone { border:3px dashed #A0522D; padding:40px; text-align:center; cursor:pointer; margin-bottom:20px; border-radius:15px; transition:0.3s;}
    .upload-zone.dragover { background:rgba(160,82,45,0.1);}
    .uploaded-image img { max-width:100%; border-radius:10px; }
    .button-group { display:flex; justify-content:center; gap:20px; margin-bottom:20px;}
    button { padding:10px 25px; border:none; border-radius:25px; background:#A0522D; color:#fff; font-weight:bold; cursor:pointer; transition:0.3s;}
    button:disabled { background: rgba(160,82,45,0.4); cursor:not-allowed;}
    .results { display:flex; gap:20px; justify-content:space-around; flex-wrap:wrap;}
    .result-box { background: #fff3e6; padding:20px; border-radius:15px; width:45%; text-align:center; }
    .result-box img, .result-box svg { max-width:100%; border-radius:10px; }
    .color-options { display:flex; justify-content:center; gap:15px; margin-top:10px; flex-wrap:wrap;}
    .color-options label { display:flex; flex-direction:column; font-size:0.9rem; color:#6B3E1F;}
</style>
</head>
<body>

<div class="container">
    <h1>ðŸŒ¸ Kolam Analyzer & Recreator ðŸŒ¸</h1>

    <!-- Upload Section -->
    <div class="upload-zone" id="uploadZone">
        <p>Drag & drop or click to upload a Kolam image</p>
        <input type="file" id="imageInput" accept="image/*" style="display:none;">
        <div class="uploaded-image" id="uploadedImage" style="display:none;">
            <img id="previewImage">
            <button onclick="removeImage()">âœ•</button>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="button-group">
        <button id="analyzeBtn" disabled onclick="startAnalysis()">Analyze</button>
        <button id="recreateBtn" disabled onclick="startRecreation()">Recreate</button>
    </div>

    <!-- Color & Size Options -->
    <div class="color-options">
        <label>Line Color: <input type="color" id="strokeColor" value="#000000"></label>
        <label>Dot Color: <input type="color" id="dotColor" value="#ff0000"></label>
        <label>Line Width: <input type="number" id="strokeWidth" value="2" min="1"></label>
        <label>Dot Radius: <input type="number" id="dotRadius" value="3" min="1"></label>
    </div>

    <!-- Results -->
    <div class="results">
        <div class="result-box" id="analysisResults" style="display:none;">
            <h3>Analysis</h3>
            <div id="resultsGrid"></div>
        </div>
        <div class="result-box" id="recreationResults" style="display:none;">
            <h3>Recreation</h3>
            <div id="recreatedImageContainer"></div>
        </div>
    </div>
</div>

<script>
const FLASK_API_URL = ''; // Set your backend URL

const uploadZone = document.getElementById('uploadZone');
const imageInput = document.getElementById('imageInput');
const uploadedImageContainer = document.getElementById('uploadedImage');
const previewImage = document.getElementById('previewImage');
const analyzeBtn = document.getElementById('analyzeBtn');
const recreateBtn = document.getElementById('recreateBtn');
const resultsGrid = document.getElementById('resultsGrid');
const recreatedImageContainer = document.getElementById('recreatedImageContainer');
const analysisResults = document.getElementById('analysisResults');
const recreationResults = document.getElementById('recreationResults');

let currentFile = null;

// --- Upload Handlers ---
uploadZone.addEventListener('click', () => imageInput.click());
uploadZone.addEventListener('dragover', e => { e.preventDefault(); uploadZone.classList.add('dragover'); });
uploadZone.addEventListener('dragleave', e => { e.preventDefault(); uploadZone.classList.remove('dragover'); });
uploadZone.addEventListener('drop', e => { e.preventDefault(); uploadZone.classList.remove('dragover'); handleUpload(e.dataTransfer.files[0]); });
imageInput.addEventListener('change', e => handleUpload(e.target.files[0]));

function handleUpload(file){
    if(!file.type.startsWith('image/')) return alert('Not an image.');
    currentFile = file;
    previewImage.src = URL.createObjectURL(file);
    uploadedImageContainer.style.display='block';
    analyzeBtn.disabled=false;
    recreateBtn.disabled=false;
}

function removeImage(){
    currentFile=null;
    uploadedImageContainer.style.display='none';
    analyzeBtn.disabled=true;
    recreateBtn.disabled=true;
    resultsGrid.innerHTML='';
    recreatedImageContainer.innerHTML='';
    analysisResults.style.display='none';
    recreationResults.style.display='none';
}

// --- Analysis ---
async function startAnalysis(){
    if(!currentFile) return;
    analyzeBtn.disabled=true; recreateBtn.disabled=true;

    const formData = new FormData();
    formData.append('image', currentFile);

    try{
        const resp = await fetch(`${FLASK_API_URL}/analyze`, { method:'POST', body: formData });
        if(!resp.ok) throw new Error('Analysis failed');
        const data = await resp.json();
        displayAnalysis(data);
    } catch(e){ alert('Analysis error'); console.error(e); }
    finally{ analyzeBtn.disabled=false; recreateBtn.disabled=false; }
}

function displayAnalysis(data){
    resultsGrid.innerHTML='';
    const principles = {
        "Dot Count": data.dot_count,
        "Contour Count": data.contour_count,
        "Grid": `${data.grid.rows} x ${data.grid.cols}`,
        "Symmetric": data.is_symmetric?'Yes':'No'
    };
    for(const [k,v] of Object.entries(principles)){
        const div = document.createElement('div');
        div.textContent = `${k}: ${v}`;
        resultsGrid.appendChild(div);
    }
    analysisResults.style.display='block';
}

// --- Recreation (SVG) ---
async function startRecreation(){
    if(!currentFile) return;
    recreateBtn.disabled=true; analyzeBtn.disabled=true;

    const formData = new FormData();
    formData.append('image', currentFile);
    formData.append('stroke_color', document.getElementById('strokeColor').value);
    formData.append('dot_color', document.getElementById('dotColor').value);
    formData.append('stroke_width', document.getElementById('strokeWidth').value);
    formData.append('dot_radius', document.getElementById('dotRadius').value);

    try{
        const resp = await fetch(`${FLASK_API_URL}/recreate`, { method:'POST', body:formData });
        if(!resp.ok) throw new Error('Recreation failed');
        const svgText = await resp.text();
        displayRecreatedSVG(svgText);
    } catch(e){ alert('Recreation error'); console.error(e); }
    finally{ recreateBtn.disabled=false; analyzeBtn.disabled=false; }
}

function displayRecreatedSVG(svgContent){
    recreatedImageContainer.innerHTML = svgContent; // Inline SVG
    recreationResults.style.display='block';
    analysisResults.style.display='none';
}

</script>

</body>
</html>
